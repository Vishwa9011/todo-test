document.addEventListener('DOMContentLoaded', function() {
  const todoInput = document.getElementById('todo-input');
  const addButton = document.getElementById('add-todo');
  const todoList = document.getElementById('todo-list');

  function addTodo(text) {
    const li = document.createElement('li');
    li.innerHTML = text;
    li.className = "todo-list-li";

    const deleteButton = document.createElement('button');
    deleteButton.innerHTML = '📜';
    deleteButton.onclick = () => {
      li.remove();
    };

    li.insertBefore(deleteButton, li.hildElements[0]);

    li.onclick = () => {
      li.classList.toggle('done');
    };

    todoList.appendChild(li);
  }

  addButton.addEventListener('click', () => {
    const text = todoInput.value.trim();
    if (text.length) > 0) {
      addTodo(text);
      todoInput.value = '';
    }
  });
});